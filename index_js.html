<!DOCTYPE html>
<html>

<body>

    <h1>Javascript Project 5</h1>
    <h2>Joshua Hummell</h2>

    <p>Input the string you want to reverse</p>

    <form id="frm1" action="/action_page.php">
        Input String: <input type="text" name="fname" value="Data 608 is great!" id="val"><br>
    </form>
    <br>
    <button onclick="reverseWords()">Reverse</button>

    <p id="demo"></p>
    <br>
    <br>
    <h3>Multiplication Table:</h3>


    <form id="frm2" action="/action_page.php">
        Input number: <input type="number" name="num" value="2" id="val2"><br>
    </form>
    <br>
    <input type="button" value="Generate a table." onclick="generate_table()">

    <br>
    <br>
    <h3>Presidential Table:</h3>
    <p>Click 'Filter' to get the table, then type in any name or letter to filter further</p>
    <form>
        <input id="word_pres" type="text" size="20">
        <input type="button" value="Filter" onclick="clear_pres(); callback_pres()">
        <input type="reset" value="Clear" onclick="clear_pres()">
    </form>

    <div id="target_pres"></div>


</body>
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script>
    function reverseWords() {
        var fname = document.getElementById('val').value
        let reverseWordArr = fname.toString().split(" ").map(word => word.split("").reverse().join(""));
        t = reverseWordArr.join(" ")
        document.getElementById("demo").innerHTML = t;
    }




    function generate_table() {
        var num1 = document.getElementById('val2').value

        // adapted from: https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Traversing_an_HTML_table_with_JavaScript_and_DOM_Interfaces
        // get the reference for the body 
        var body = document.getElementsByTagName("body")[0];

        // creates a <table> element and a <tbody> element
        var tbl = document.createElement("table");
        var tblBody = document.createElement("tbody");

        // creating all cells
        //Easiest way to get the Multiplication table to work was a third counter, k
        var k = 1
        for (var i = 0; i < 5; i++) {
            // creates a table row
            var row = document.createElement("tr");

            for (var j = 0; j < 4; j++) {
                // Create a <td> element and a text node, make the text
                // node the contents of the <td>, and put the <td> at
                // the end of the table row
                var cell = document.createElement("td");
                var cellText = document.createTextNode(num1 * k);
                cell.appendChild(cellText);
                row.appendChild(cell);
                k++
            }

            // add the row to the end of the table body 
            tblBody.appendChild(row);
        }

        // put the <tbody> in the <table>
        tbl.appendChild(tblBody);
        // appends <table> into <body>
        body.appendChild(tbl);
        // sets the border attribute of tbl to 2;
        tbl.setAttribute("border", "2");
    }

    function update_pres(data, columns) {
        var table = d3.select('#target_pres').append('table')
        var thead = table.append('thead')
        var tbody = table.append('tbody')
        thead.append('tr').selectAll('th').data(columns).enter().append('th').text(function(d) {
            return d
        })
        var rows = tbody.selectAll('tr').data(data).enter().append('tr')
        var cells = rows.selectAll('td').data(function(row) {
            return columns.map(function(column) {
                return {
                    column: column,
                    value: row[column]
                }
            })
        }).enter().append('td').text(function(d) {
            return d.value
        })
        return table;
    }

    function clear_pres() {
        var table = d3.select('#target_pres').selectAll("table").remove();
    }

    function callback_pres() {
        var pres = document.getElementById('word_pres').value
        var github = 'https://raw.githubusercontent.com/charleyferrari/CUNY_DATA_608/master/module5/data/presidents.csv'
        var t = d3.csv(github, function(data) {
            var columns = ['Name', 'Height', 'Weight'];
            var subset = data.filter(function(d) {
                return d.Name.toLowerCase().indexOf(pres) !== -1
            });
            update_pres(subset, columns)
        });
    }

</script>


</html>
